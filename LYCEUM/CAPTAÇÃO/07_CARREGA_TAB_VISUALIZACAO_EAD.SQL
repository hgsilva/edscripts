

DELETE  DM_MKT.dbo.ACOMP_ACUM_VEST_DIARIO_EAD 
WHERE	ANO_INGRESSO = (2019)
						--SELECT	DISTINCT ANO
						--FROM	IE_LY_OPCOES_APP
						--WHERE	APLICACAO = 'VESTIBULAR_EAD_TRIMESTRAL') 
						 
AND		SEM_INGRESSO in ( '8', '9', '10','11')
						--SELECT	DISTINCT PERIODO
						--FROM	IE_LY_OPCOES_APP
						--WHERE	APLICACAO = 'VESTIBULAR_EAD_TRIMESTRAL'
						--)

insert into DM_MKT.dbo.ACOMP_ACUM_VEST_DIARIO_EAD

SELECT A.CURSO
             ,A.NOME
             ,CASE  WHEN COALESCE(INEP_PRESENCIAL,'P') = 'P' THEN 'PRESENCIAL'
                    WHEN COALESCE(INEP_PRESENCIAL,'P') = 'S' THEN 'SEMIPRESENCIAL'
                    WHEN COALESCE(INEP_PRESENCIAL,'P') = 'D' THEN 'EAD'
                    END MODALIDADE
             ,case when A.TURNO = 'not' then 'Noturno'
	      else a.turno
	      end turno	
             ,CAMPUS
             ,SEMANAS_INICIO_AULA
             ,A.TIPO
             ,ANO_INGRESSO
             ,SEM_INGRESSO
             ,ANO_SEM
             ,TIPO_CONCURSO
             ,QTD 
FROM	[POLARIS02\BDIESBPROD].LYCEUM.DBO.VW_VISAO_SEMANAL_EAD A
JOIN	[POLARIS02\BDIESBPROD].LYCEUM.DBO.LY_CURSO B ON A.CURSO = B.CURSO
where	B.CURSO IN (
					SELECT	CURSO 
					FROM	[POLARIS02\BDIESBPROD].LYCEUM.DBO.LY_CURSO 
					WHERE	INEP_PRESENCIAL IN ('S','D')
					)
--ANO_INGRESSO = (
--						SELECT	DISTINCT ANO
--						FROM	[POLARIS02\BDIESBPROD].LYCEUM.DBO.IE_LY_OPCOES_APP
--						WHERE	APLICACAO = 'VESTIBULAR_EAD_TRIMESTRAL'
--						)
--and		SEM_INGRESSO = (
--						SELECT	DISTINCT PERIODO
--						FROM	[POLARIS02\BDIESBPROD].LYCEUM.DBO.IE_LY_OPCOES_APP
--						WHERE	APLICACAO = 'VESTIBULAR_EAD_TRIMESTRAL'
--						)